global
    log /dev/log local0
    maxconn 4096
    daemon

defaults
    log     global
    mode    http
    option  httplog
    option  dontlognull
    timeout connect 5s
    timeout client  30s
    timeout server  30s

frontend http_front
    bind *:{{ haproxy_frontend_port }}
    default_backend http_back

backend http_back
    balance roundrobin
    option httpchk GET {{ haproxy_health_path }}
{% for b in web_backends %}
    server {{ b.name }} {{ b.host }}:{{ b.port }} check inter 2s fall 3 rise 2
{% endfor %}

